# 字数统计

> **⚠️ 免责声明**：本文档由 **GLM4.7** 自动生成，内容可能存在错误或不完整之处。**请以人工书写的官方文档为准**。

---

字数统计是 Andrea Novel Helper 的**核心功能**，显示项目中所有章节的字数信息。

## 打开字数统计

在 VS Code 左侧活动栏中，点击 **字数统计** 图标（类似列表图标），即可打开字数统计面板。

## 界面说明

字数统计以树形结构显示你的项目：

```
📁 我的小说
  📁 第一卷
    📄 第一章.md      3,256 字
    📄 第二章.md      2,890 字
  📁 第二卷
    📄 第三章.md      3,102 字
━━━━━━━━━━━━━━━━━━━━━
总计: 9,248 字
```

### 显示信息

每个文件显示：
- 文件名
- 字数统计
- 缓存状态（可选）

## 字数统计方式

字数统计支持多种统计方式，默认显示 **含标点字数**：

| 方式 | 说明 |
|------|------|
| 含标点 | 包含所有标点符号的字数（默认） |
| 不含标点 | 排除标点符号的字数 |
| 词计 | 基于中文分词的词汇数 |

## 新建文件/文件夹

在字数统计面板底部有两个特殊按钮：

- **+ 新建文章** - 创建新的 Markdown 或文本文件
- **+ 新建文件夹** - 创建新的文件夹

点击后会弹出对话框：
1. 选择文件类型（Markdown 或 Text）
2. 输入文件名
3. 文件自动创建并打开

## 文件排序

字数统计支持两种排序模式：

### 自动模式（默认）

按文件名自动排序，无需手动干预。

### 手动模式

允许自定义章节顺序。

#### 启用手动排序

1. 右键点击任意**文件夹**
2. 选择 **切换手动排序**

#### 调整顺序

启用手动排序后：
- **拖拽文件** - 直接拖动到想要的位置
- **右键菜单**：
  - 在此处上方/下方新建文件
  - 设置索引（手动输入数字）

#### 排序索引

手动排序使用数字索引：
- 默认步长为 10（10, 20, 30...）
- 要在 10 和 20 之间插入，可以设为 15
- 索引越小，排序越靠前

## 文件和文件夹操作

### 打开文件
- 双击文件名
- 或右键选择 **打开**

### 创建文件/文件夹

**在指定位置插入**：
1. 右键点击文件
2. 选择 **在此处上方新建文件** 或 **在此处下方新建文件**
3. 输入名称

### 重命名
1. 右键点击文件或文件夹
2. 选择 **重命名**
3. 输入新名称

### 删除
1. 右键点击文件或文件夹
2. 选择 **删除**
3. 确认删除

> ⚠️ **警告**：删除操作不可撤销，请谨慎操作！

### 在文件管理器中显示
1. 右键点击文件或文件夹
2. 选择 **在文件管理器中显示**

## 刷新字数统计

### 自动刷新

字数统计会在以下情况自动刷新：
- 保存文件时
- 切换文件时
- 文件内容变化时

### 手动刷新

如果需要强制刷新：
- 右键点击面板空白处
- 选择 **刷新字数统计**

或使用命令面板（`Ctrl+Shift+P`）：
- 输入 `Andrea Novel Helper: 刷新字数统计`

### 强制重算

如果字数统计不准确：
- 右键点击文件或文件夹
- 选择 **强制重算**
- 或使用命令 `Andrea Novel Helper: 强制重算所有字数`

## 忽略文件

你可以设置某些文件或文件夹不计入字数统计。

### 使用 .wcignore

在项目根目录创建 `.wcignore` 文件：

```gitignore
# 忽略草稿文件夹
draft/

# 忽略临时文件
temp/
*.tmp

# 忽略特定文件
notes.md
backup/

# 忽略 VSCode 配置（推荐）
.vscode/
```

### 使用 .gitignore

字数统计也会自动读取 `.gitignore` 文件中的规则。

## 缓存机制

字数统计使用缓存来提高性能：
- 首次统计较慢
- 之后的打开会立即显示
- 如果有 Git 仓库，缓存会更可靠

### 缓存验证

如果使用 Git：
- 扩展会自动验证缓存的准确性
- 当文件被 Git 修改时，会自动重新统计

## 复制统计信息

1. 右键点击文件或文件夹
2. 选择 **复制统计信息**
3. 粘贴到其他位置

## 右键菜单完整列表

| 菜单项 | 说明 |
|--------|------|
| 打开 | 在编辑器中打开文件 |
| 在文件管理器中显示 | 在系统文件管理器中显示 |
| 重命名 | 重命名文件或文件夹 |
| 删除 | 删除文件或文件夹 |
| 刷新字数 | 刷新选中项的字数 |
| 强制重算 | 清除缓存并重新统计 |
| 切换手动排序 | 启用/关闭手动排序 |
| 设置索引 | 手动输入排序数字 |
| 生成索引（从文件名） | 从文件名提取数字作为索引 |
| 清除索引 | 清除手动排序索引 |
| 在此处上方/下方新建文件 | 在当前位置创建新文件 |
| 在此处上方/下方新建文件夹 | 在当前位置创建新文件夹 |
| 复制统计信息 | 复制字数信息到剪贴板 |

## 常见问题

### 字数统计不准确？

1. 尝试 **强制重算**
2. 检查文件是否在 `.wcignore` 或 `.gitignore` 中
3. 确认使用的是正确的统计方式

### 显示的字数和其他软件不一样？

不同的软件统计方式可能略有差异：
- 本扩展使用标准的 Unicode 字符统计
- 一个汉字 = 1 个字
- 一个标点 = 1 个字
- 一个英文单词 = 1 个字（使用分词）

### 如何只统计部分文件？

使用 `.wcignore` 文件排除不需要统计的文件。

### 手动排序的索引是什么？

索引是用于排序的数字：
- 数字越小，排序越靠前
- 可以是小数（如 5.5）
- 建议使用 10 的倍数（10, 20, 30）

## 相关设置

在 VS Code 设置中搜索 `AndreaNovelHelper.wordCount`：

| 设置项 | 说明 | 默认值 |
|--------|------|--------|
| `order.step` | 手动排序索引步长 | 10 |
| `order.padWidth` | 索引显示宽度 | 3 |
| `order.autoResequence` | 自动重新排序 | true |
| `order.showIndexInLabel` | 在标签中显示索引 | false |

## 相关功能

- [大纲视图](./outline.md) - 查看章节结构
- [包管理器](./packages.md) - 管理角色和设定包
- [AutoGit](./autogit.md) - 自动版本管理
