# 工具对比

img2pic 提供了多个工具来处理 AI 生成的像素风格图像。本文档对比各个工具的特点，帮助你选择合适的工具。

## 工具概览

| 工具 | 算法基础 | 检测精度 | 处理速度 | 复杂度 |
|------|---------|---------|---------|--------|
| `energ` | 能量图 + 滑动窗口 | 高 | 中等 | 高 |
| `edge_detect_pixelize.py` | Sobel 边缘检测 | 中 | 快 | 低 |
| `grid_sampling_pixelize.py` | 峰值检测 + 多尺度 | 高 | 中等 | 中 |
| `demo_pixelize.py` | 简单下采样 | 低（不检测） | 最快 | 最低 |

## 详细对比

### 检测精度

| 工具 | 检测能力 | 局限性 |
|------|---------|--------|
| **energ** | 高精度网格检测，支持局部峰值和插值 | 计算量较大 |
| **edge_detect** | 中等精度，依赖全局阈值 | 无法检测局部峰值 |
| **grid_sampling** | 高精度，多尺度检测 | 可能过度检测 |
| **demo** | 不检测网格，直接下采样 | 无法保留原始网格结构 |

### 处理速度

| 工具 | 速度 | 适用场景 |
|------|------|---------|
| **energ** | 中等 | 需要精度的场景 |
| **edge_detect** | 快 | 快速预览 |
| **grid_sampling** | 中等 | 平衡精度和速度 |
| **demo** | 最快 | 简单像素化 |

### 自适应能力

| 工具 | 自动检测 | 参数调整 | 灵活性 |
|------|---------|---------|--------|
| **energ** | ✅ 像素尺寸、网格线 | 高 | 高 |
| **edge_detect** | ❌ 固定参数 | 低 | 低 |
| **grid_sampling** | ✅ 网格间距 | 中 | 中 |
| **demo** | ❌ 不检测 | 低 | 低 |

## 功能对比

### 高级功能

| 功能 | energ | edge_detect | grid_sampling | demo |
|------|-------|-------------|--------------|------|
| 局部峰值检测 | ✅ | ❌ | ✅ | ❌ |
| 网格插值 | ✅ | ❌ | ✅ | ❌ |
| 方向性增强 | ✅ | ❌ | ❌ | ❌ |
| 多尺度检测 | ❌ | ❌ | ✅ | ❌ |
| 颜色合并 | ✅ | ❌ | ✅ | ❌ |
| 多种采样模式 | ✅ | ❌ | ❌ | ❌ |

### 颜色处理

| 功能 | energ | edge_detect | grid_sampling | demo |
|------|-------|-------------|--------------|------|
| 颜色量化 | ✅ | ✅ | ✅ | ✅ |
| 智能颜色数 | ✅ | ❌ | ❌ | ❌ |
| 相似颜色合并 | ✅ | ❌ | ✅ | ❌ |
| 自定义颜色数 | ✅ | ✅ | ✅ | ✅ |

### 调试功能

| 功能 | energ | edge_detect | grid_sampling | demo |
|------|-------|-------------|--------------|------|
| 能量图输出 | ✅ | ❌ | ❌ | ❌ |
| 网格可视化 | ✅ | ✅ | ✅ | ❌ |
| 采样点可视化 | ❌ | ❌ | ✅ | ❌ |

## 适用场景

### energ

**推荐使用**：
- 复杂的 AI 生成像素风格图像
- 图像中存在局部能量尖峰
- 网格线能量分布不均匀
- 需要高精度网格检测
- 需要自适应参数调整
- 需要方向性增强

**不推荐**：
- 简单的规则网格
- 需要极快处理速度

### edge_detect_pixelize.py

**推荐使用**：
- 简单的像素风格图像
- 边缘清晰的图像
- 规则或近似规则的网格
- 需要快速处理
- 需要调试可视化

**不推荐**：
- 复杂的 AI 生成图像
- 需要高精度检测
- 网格不规则的图像

### grid_sampling_pixelize.py

**推荐使用**：
- 需要多尺度边缘检测
- 不规则网格需要规律化
- 需要颜色合并功能
- 需要调试采样点

**不推荐**：
- 极其简单的图像（用 demo 即可）
- 需要方向性增强

### demo_pixelize.py

**推荐使用**：
- 学习像素化基本原理
- 快速预览效果
- 规则像素化（不检测网格）
- 自定义像素网格尺寸

**不推荐**：
- 需要检测现有网格
- 需要保留原始网格结构

## 选择指南

### 按图像类型选择

```
┌─────────────────────────────────────────────────────┐
│  图像类型                                          │
├─────────────────────────────────────────────────────┤
│                                                     │
│  AI 生成像素风格  ────────►  energ                 │
│  │  ├─ 复杂、不规则                                  │
│  │  └─ 局部能量尖峰                                  │
│                                                     │
│  简单像素风格    ────────►  edge_detect            │
│  │  ├─ 边缘清晰                                      │
│  │  └─ 规则网格                                      │
│                                                     │
│  不规则网格      ────────►  grid_sampling          │
│  │  ├─ 多尺度边缘                                    │
│  │  └─ 需要规律化                                    │
│                                                     │
│  普通图像        ────────►  demo                   │
│     └─ 不需要检测网格                                │
│                                                     │
└─────────────────────────────────────────────────────┘
```

### 按需求选择

```
┌─────────────────────────────────────────────────────┐
│  需求                                              │
├─────────────────────────────────────────────────────┤
│                                                     │
│  最高精度         ────────►  energ                 │
│  快速处理         ────────►  edge_detect / demo     │
│  多尺度检测       ────────►  grid_sampling          │
│  方向性增强       ────────►  energ                 │
│  颜色合并         ────────►  grid_sampling / energ  │
│  多种采样模式     ────────►  energ                 │
│  调试可视化       ────────►  edge_detect / grid_sampling │
│                                                     │
└─────────────────────────────────────────────────────┘
```

## 使用建议

### 初次使用

1. 先尝试 `edge_detect_pixelize.py`（简单快速）
2. 如果效果不好，尝试 `grid_sampling_pixelize.py`
3. 对于复杂图像，使用 `energ`

### 参数调优

1. 从默认参数开始
2. 根据输出调整主要参数
3. 使用调试模式查看检测效果
4. 迭代优化

### 批量处理

```bash
# 使用脚本批量处理
for img in image/*.png; do
    python energ --in "$img" --sample --upscale 4
done
```

### 组合使用

可以组合使用多个工具：

```bash
# 先用 edge_detect 快速预览
python edge_detect_pixelize.py --in image.png --debug

# 再用 energ 精确处理
python energ --in image.png --sample --upscale 4
```

## 性能对比

基于 512x512 图像的测试（仅供参考）：

| 工具 | 处理时间 | 内存占用 |
|------|---------|---------|
| demo_pixelize | < 0.1s | ~50MB |
| edge_detect | ~0.3s | ~100MB |
| grid_sampling | ~0.5s | ~150MB |
| energ | ~1s | ~200MB |

## 总结

| 工具 | 推荐度 | 适用场景 |
|------|--------|---------|
| **energ** | ★★★★★ | 复杂 AI 图像、需要最高精度 |
| **edge_detect** | ★★★☆☆ | 简单图像、快速处理 |
| **grid_sampling** | ★★★★☆ | 不规则网格、颜色合并 |
| **demo** | ★★☆☆☆ | 学习、简单像素化 |

---

[← 返回用户指南](../)
